<!--The content below is only a placeholder and can be replaced.-->
<h1>
  Chat Box
</h1>
<div>
  <!-- <span class="new-day">Aug 13, 2019</span> -->
  <div #scrollbox [scrollTop]="scrollbox.scrollHeight" class="d-flex flex-column scrollable">
    <ng-container *ngFor="let message of messages; let i=index">
      <span *ngIf="message.datechange && i !== messages.length-1" class="new-day">{{
        message.datechange | date: 'mediumDate' | recentDate
      }}</span>
      <p *ngIf="message.joined" class="text-success">{{ message.joined }}</p>
      <p *ngIf="message.left" class="text-danger">{{ message.left }}</p>
      <div *ngIf="message.username && isMobile" dropdown [ngClass]="
          message.username === user.username ? 'current-user' : 'other-user'
        ">
        <fa-icon icon="ellipsis-v" *ngIf="message.username === user.username"
          class="sticky-more" dropdownToggle aria-controls="dropdown-basic" size="xs">
        </fa-icon>
        <ul *dropdownMenu class="dropdown-menu dropdown-menu-right sticky-menu" role="menu"
          aria-labelledby="button-basic">
          <li role="menuitem" (click)="deleteMessage(message)" class="delete">Delete</li>
        </ul>
        <strong class="d-block" *ngIf="message.username !== user.username">{{
          message.username | uppercase
        }}</strong>
        <span [innerHTML]="message.msg"></span>
        <span class="message-date">{{
          message.createdAt | date: 'shortTime'
        }}</span>
      </div>
      <div *ngIf="message.username && !isMobile" (mouseover)="hover[i] = true" (mouseout)="hover[i] = false" dropdown [ngClass]="
          message.username === user.username ? 'current-user' : 'other-user'
        ">
        <fa-icon icon="ellipsis-v" *ngIf="message.username === user.username" [class.d-none]="!hover[i]"
          class="sticky-more" dropdownToggle aria-controls="dropdown-basic" size="xs">
        </fa-icon>
        <ul *dropdownMenu class="dropdown-menu dropdown-menu-right sticky-menu" role="menu"
          aria-labelledby="button-basic">
          <li role="menuitem" (click)="deleteMessage(message)" class="delete">Delete</li>
        </ul>
        <strong class="d-block" *ngIf="message.username !== user.username">{{
          message.username | uppercase
        }}</strong>
        <span [innerHTML]="message.msg"></span>
        <span class="message-date">{{
          message.createdAt | date: 'shortTime'
        }}</span>
      </div>
    </ng-container>
  </div>
  <form [formGroup]="messageForm" class="align-self-end" (ngSubmit)="sendMessage()">
    <div class="form-group">
      <input formControlName="message" class="form-control" type="text" autofocus placeholder="Enter message" />
      <button class="btn btn-primary" [disabled]="loading || checkValid()">
        Send
      </button>
      <button class="btn btn-warning" [disabled]="loading" type="button" (click)="sendLocation()">
        Share Location
      </button>
    </div>
  </form>
</div>
